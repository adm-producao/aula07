---
title: "Administra√ß√£o da Produ√ß√£o"
subtitle: "Unidade 07: Programa√ß√£o da produ√ß√£o"
author: 
  - <br></br>Renata Oliveira
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["slides.css", "xaringan-themer.css"]
    nature:
      ratio: "16:9"
      highlightLines: true
      highlightStyle: solarized-light
      countIncrementalSlides: false
      slideNumberFormat: |
         <div class="progress-bar-container">
           <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
           </div>
         </div>

---

```{r child = "setup.Rmd"}
```

```{r xaringan-tile-view, echo=FALSE}
xaringanExtra::use_tile_view()
```

```{r xaringan-editable, echo=FALSE}
xaringanExtra::use_editable(expires = 1)
```

```{r xaringanExtra-clipboard, echo=FALSE}
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clipboard\"></i>",
    success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\"></i>",
    error_text = "<i class=\"fa fa-times-circle\" style=\"color: #F94144\"></i>"
  ),
  rmarkdown::html_dependency_font_awesome()
)
```

```{r xaringan-fit-screen, echo=FALSE}
xaringanExtra::use_fit_screen()
```

```{r xaringan-extra-styles, echo=FALSE}
xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,         #<<
  mute_unhighlighted_code = TRUE  #<<
)
```

```{r xaringan-scribble, echo=FALSE}
xaringanExtra::use_scribble()
```

```{r teste, include=FALSE} 
knitr::opts_chunk$set(
	message = FALSE,
	warning = FALSE,
	include = FALSE
)
library(tidyverse) 
library(knitr) 
library(kableExtra) 
library(DiagrammeR) 
library(plotly)
```


# Objetivos da Aula

.pull-left[
## O que vamos aprender:

‚úÖ Conceitos fundamentais de programa√ß√£o da produ√ß√£o

‚úÖ Como criar e analisar roteiros de produ√ß√£o

‚úÖ T√©cnicas de sequenciamento de opera√ß√µes

‚úÖ M√©todos de c√°lculo de carga de m√°quinas

]

.pull-right[
## Por que √© importante?

- **Efici√™ncia operacional**: Maximizar utiliza√ß√£o de recursos

- **Redu√ß√£o de custos**: Minimizar tempos ociosos

- **Cumprimento de prazos**: Planejamento adequado

- **Competitividade**: Otimiza√ß√£o dos processos
]


---

# O que √© um Roteiro de Produ√ß√£o?

## Defini√ß√£o

O **roteiro de produ√ß√£o** (ou roteiro de fabrica√ß√£o) √© um documento t√©cnico que descreve:

.pull-left[
- **Sequ√™ncia** de opera√ß√µes necess√°rias
- **M√°quinas/equipamentos** utilizados
- **Tempos padr√£o** de processamento
- **Ferramentas e dispositivos** necess√°rios
- **Materiais** consumidos em cada etapa
]

.pull-right[
- **Especifica√ß√µes t√©cnicas** de cada opera√ß√£o
- **Inspe√ß√µes** de qualidade
- **Movimenta√ß√µes** entre postos
- **Preced√™ncias** entre opera√ß√µes
]

---

# Componentes de um Roteiro
```{r echo=FALSE, message=FALSE, warning=FALSE}
componentes <- data.frame( Componente = c("Opera√ß√£o", "Posto de Trabalho", "Tempo Setup", "Tempo Unit√°rio", "Ferramental", "Preced√™ncia"), "Descri√ß√£o" = c("Descri√ß√£o da atividade a ser executada", "M√°quina ou centro de trabalho respons√°vel", "Tempo de prepara√ß√£o da m√°quina (min)", "Tempo de processamento por unidade (min)", "Ferramentas, dispositivos e fixtures necess√°rios", "Opera√ß√µes que devem ser conclu√≠das antes"), Exemplo = c("Tornear eixo √ò50mm", "Torno CNC 01", "15", "3.5", "Placa 3 castanhas, Bedame", "OP 010") )

componentes %>% 
  kable(format = "html") %>% 
  kable_styling(bootstrap_options = c("striped", "hover"), font_size = 14)
```

---

# Exemplo Pr√°tico: Roteiro de Produ√ß√£o

**Produto:** Eixo Mec√¢nico  
**Material:** A√ßo 1045  
**Quantidade:** 100 unidades

```{r echo=FALSE, message=FALSE, warning=FALSE}
roteiro <- data.frame( Op = c("010", "020", "030", "040", "050"), "Descri√ß√£o" = c("Cortar barra", "Tornear desbaste", "Tornear acabamento", "Furar centro", "Inspe√ß√£o dimensional"), "M√°quina" = c("Serra", "Torno CNC-01", "Torno CNC-01", "Furadeira", "Sala metrologia"), Setup_min = c(5, 20, 10, 15, 0), Tempo_Unit_min = c(2.0, 8.5, 4.2, 3.0, 2.5), "Preced√™ncia" = c("-", "010", "020", "030", "040") )

roteiro %>% 
  kable(format = "html", col.names = c("Op", "Descri√ß√£o", "M√°quina", "Setup (min)", "Tempo Unit. (min)", "Preced√™ncia")) %>% 
  kable_styling(bootstrap_options = c("striped", "hover"), font_size = 13)
```
---

# Visualizando o Roteiro
```{r roteiro-diagrama, echo=TRUE, fig.height=5} 

grViz(" digraph roteiro { graph [rankdir=LR, bgcolor='transparent'] node [shape=box, style=filled, fillcolor='lightblue', fontname='Arial']

Cortar [label='OP 010\nCortar\nSerra\n2.0 min'] Desbastar [label='OP 020\nTornear Desbaste\nTorno CNC-01\n8.5 min'] Acabamento [label='OP 030\nTornear Acabamento\nTorno CNC-01\n4.2 min'] Furar [label='OP 040\nFurar Centro\nFuradeira\n3.0 min'] Inspecao [label='OP 050\nInspe√ß√£o\nMetrologia\n2.5 min']

Cortar -> Desbastar -> Acabamento -> Furar -> Inspecao } ")
```

---

# Sequenciamento: Conceitos Fundamentais

## O que √©?

Processo de **determinar a ordem** em que os trabalhos/tarefas ser√£o processados nas m√°quinas dispon√≠veis.

## Objetivos Principais:

.pull-left[
- ‚è±Ô∏è **Minimizar tempo total** (makespan)
- üìÖ **Cumprir prazos** de entrega
- üí∞ **Reduzir custos** de estoque
]

.pull-right[
- ‚öôÔ∏è **Maximizar utiliza√ß√£o** de m√°quinas
- üìä **Balancear carga** de trabalho
- üéØ **Minimizar atrasos**
]

---

# Regras de Sequenciamento
```{r echo=FALSE, message=FALSE, warning=FALSE}

regras <- data.frame( Regra = c("FCFS", "SPT", "EDD", "LPT", "CR", "SLACK"), Nome = c("First Come, First Served", "Shortest Processing Time", "Earliest Due Date", "Longest Processing Time", "Critical Ratio", "Menor Folga"), "Caracter√≠stica" = c("Ordem de chegada", "Menor tempo de processamento primeiro", "Menor data de entrega primeiro", "Maior tempo de processamento primeiro", "Raz√£o entre tempo at√© entrega e tempo restante", "Menor tempo de folga primeiro"), "Aplica√ß√£o" = c("Simples, justo", "‚Üì Tempo m√©dio fila", "‚Üì Atraso m√°ximo", "Tarefas longas", "Urg√™ncia din√¢mica", "Urg√™ncia est√°tica") )

regras %>% 
  kable(format = "html") %>% 
  kable_styling(bootstrap_options = c("striped", "hover"), font_size = 12) %>% 
  column_spec(1, bold = TRUE, color = "white", background = "#3498db")
```
---

# Exemplo Pr√°tico: Sequenciamento SPT
```{r sequenciamento-spt, echo=TRUE}

# Dados dos trabalhos
trabalhos <- data.frame( Job = c("A", "B", "C", "D", "E"), Tempo_Proc = c(8, 3, 7, 12, 5), Data_Entrega = c(15, 10, 20, 25, 12) )

#Aplicando SPT (Shortest Processing Time)
trabalhos_spt <- trabalhos %>% arrange(Tempo_Proc) %>% mutate( Inicio = cumsum(dplyr::lag(Tempo_Proc, default = 0)), Fim = Inicio + Tempo_Proc, Atraso = pmax(0, Fim - Data_Entrega) )

print(trabalhos_spt)
```

---

# An√°lise do Sequenciamento SPT
                               
```{r metricas-spt, echo=TRUE}

# Calculando m√©tricas de desempenho
metricas <- data.frame( M√©trica = c("Makespan (tempo total)", "Tempo m√©dio de fluxo", "Atraso m√©dio", "N√∫mero de trabalhos atrasados", "Utiliza√ß√£o (%)"), Valor = c( max(trabalhos_spt$Fim), mean(trabalhos_spt$Fim), mean(trabalhos_spt$Atraso), sum(trabalhos_spt$Atraso > 0), round(sum(trabalhos_spt$Tempo_Proc) / max(trabalhos_spt$Fim) * 100, 1) ) )

metricas %>% 
  kable(format = "html") %>% 
  kable_styling(bootstrap_options = c("striped", "hover"), font_size = 16, full_width = FALSE)
```

---

# Gr√°fico de Gantt - Sequenciamento
```{r gantt-chart, echo=TRUE, fig.height=5}

#Criando gr√°fico de Gantt
trabalhos_spt %>% 
  mutate(Job = factor(Job, levels = rev(Job))) %>% 
  ggplot(aes(y = Job)) + 
  geom_segment(aes(x = Inicio, xend = Fim, yend = Job), size = 10, color = "#3498db") + 
  geom_text(aes(x = (Inicio + Fim)/2, label = paste0(Tempo_Proc, " min")), color = "white", fontface = "bold") + 
  geom_vline(aes(xintercept = Data_Entrega), linetype = "dashed", color = "red", alpha = 0.6) + 
  labs(title = "Sequenciamento SPT - Diagrama de Gantt", x = "Tempo (minutos)", y = "Trabalho") + 
  theme_minimal(base_size = 14) + 
  theme(plot.title = element_text(face = "bold"))
```
---

class: inverse, center, middle

# Parte 3
## Carga de M√°quinas

---

# Carga de M√°quinas: Conceito

## Defini√ß√£o

**Carga de m√°quinas** √© o processo de:

- Alocar ordens de produ√ß√£o aos centros de trabalho
- Calcular a **capacidade necess√°ria** vs **capacidade dispon√≠vel**
- Identificar **gargalos** e **ociosidades**
- Balancear a distribui√ß√£o do trabalho

## Tipos de Carga:

.pull-left[
### Carga Finita
- Respeita capacidade m√°xima
- Considera restri√ß√µes reais
- Mais realista
]

.pull-right[
### Carga Infinita
- Ignora restri√ß√µes
- Planejamento inicial
- Identifica necessidades
]

---

# C√°lculo de Carga de M√°quinas

## F√≥rmula B√°sica:

$$\text{Carga Total} = \sum_{i=1}^{n} (T_{setup_i} + T_{proc_i} \times Q_i)$$

Onde:
- $T_{setup_i}$ = Tempo de setup da ordem $i$
- $T_{proc_i}$ = Tempo de processamento unit√°rio da ordem $i$
- $Q_i$ = Quantidade de pe√ßas da ordem $i$
- $n$ = N√∫mero de ordens

## Taxa de Utiliza√ß√£o:

$$\text{Utiliza√ß√£o (\%)} = \frac{\text{Carga Total}}{\text{Capacidade Dispon√≠vel}} \times 100$$

---

# Exemplo Pr√°tico: Carga de M√°quinas
```{r carga-maquinas-dados, echo=TRUE}

# Definindo ordens de produ√ß√£o
ordens <- data.frame( Ordem = c("OP-001", "OP-002", "OP-003", "OP-004", "OP-005"), Produto = c("Eixo A", "Polia B", "Eixo A", "Flange C", "Polia B"), Maquina = c("Torno-01", "Torno-01", "Torno-02", "Fresa-01", "Torno-02"), Setup_h = c(0.5, 0.75, 0.5, 1.0, 0.75), Tempo_Unit_h = c(0.15, 0.20, 0.15, 0.30, 0.20), Quantidade = c(50, 30, 100, 20, 40) )

# Calculando carga total por ordem
ordens <- ordens %>% mutate( Carga_Total_h = Setup_h + (Tempo_Unit_h * Quantidade), Carga_Setup_h = Setup_h, Carga_Proc_h = Tempo_Unit_h * Quantidade )

print(ordens %>% select(Ordem, Maquina, Quantidade, Carga_Total_h))
```
---

# An√°lise de Carga por M√°quina
```{r carga-por-maquina, echo=TRUE}

# Agregando carga por m√°quina
carga_maquinas <- ordens %>% 
  group_by(Maquina) %>% 
  summarise( Num_Ordens = n(), Carga_Total_h = sum(Carga_Total_h), Carga_Setup_h = sum(Carga_Setup_h), Carga_Proc_h = sum(Carga_Proc_h) ) %>% 
  mutate( Capacidade_Semanal_h = 40, #1 turno, 5 dias, 8h/dia
          Utilizacao_pct = round((Carga_Total_h / Capacidade_Semanal_h) * 100, 1), 
          Status = case_when( Utilizacao_pct > 100 ~ "üî¥ Sobrecarga", 
                              Utilizacao_pct > 85 ~ "üü° Alta", 
                              TRUE ~ "üü¢ Normal" ) )

print(carga_maquinas)
```
---

# Visualiza√ß√£o da Carga de M√°quinas
```{r plot-carga, echo=TRUE, fig.height=5} 

ggplot(carga_maquinas, aes(x = reorder(Maquina, Utilizacao_pct), y = Utilizacao_pct, fill = Status)) + geom_col(alpha = 0.8) + geom_hline(yintercept = 100, linetype = "dashed", color = "red", size = 1) + geom_hline(yintercept = 85, linetype = "dashed", color = "orange", size = 0.8) + geom_text(aes(label = paste0(Utilizacao_pct, "%")), vjust = -0.5, fontface = "bold") + coord_flip() + scale_fill_manual(values = c("üî¥ Sobrecarga" = "#e74c3c", "üü° Alta" = "#f39c12", "üü¢ Normal" = "#27ae60")) + labs(title = "Taxa de Utiliza√ß√£o por M√°quina", subtitle = "Linha tracejada: capacidade 100%", x = "M√°quina", y = "Utiliza√ß√£o (%)", fill = "Status") + theme_minimal(base_size = 14) + theme(legend.position = "bottom", plot.title = element_text(face = "bold"))
```
---

# Distribui√ß√£o da Carga: Setup vs Processamento
```{r carga-composicao, echo=TRUE, fig.height=5} 

carga_maquinas %>% select(Maquina, Carga_Setup_h, Carga_Proc_h) %>% pivot_longer(cols = c(Carga_Setup_h, Carga_Proc_h), names_to = "Tipo", values_to = "Horas") %>% mutate(Tipo = recode(Tipo, "Carga_Setup_h" = "Setup", "Carga_Proc_h" = "Processamento")) %>% ggplot(aes(x = Maquina, y = Horas, fill = Tipo)) + geom_col(position = "stack") + geom_text(aes(label = round(Horas, 1)), position = position_stack(vjust = 0.5), color = "white", fontface = "bold") + scale_fill_manual(values = c("Setup" = "#e67e22", "Processamento" = "#3498db")) + labs(title = "Composi√ß√£o da Carga de Trabalho", x = "M√°quina", y = "Horas", fill = "Tipo de Atividade") + theme_minimal(base_size = 14) + theme(legend.position = "bottom", plot.title = element_text(face = "bold"))
```
---

# Balanceamento de Carga

## Estrat√©gias para Otimizar:

.pull-left[
### Quando h√° Sobrecarga:
- üîÑ **Realoca√ß√£o** de ordens
- ‚è∞ **Horas extras** programadas
- üë• **Subcontrata√ß√£o** externa
- üìÖ **Reprograma√ß√£o** de prazos
- üÜï **Investimento** em capacidade
]

.pull-right[
### Quando h√° Ociosidade:
- üì¶ **Antecipa√ß√£o** de produ√ß√£o
- üîß **Manuten√ß√£o preventiva**
- üìö **Treinamento** de equipe
- üéØ **Melhorias** de processo
- üîç **Busca** de novos pedidos
]

---

# An√°lise de Gargalos
```{r gargalos, echo=TRUE}

# Identificando gargalos
gargalos <- carga_maquinas %>% 
  arrange(desc(Utilizacao_pct)) %>% 
  mutate(Horas_Deficit = ifelse(Utilizacao_pct > 100, 
                                 Carga_Total_h - Capacidade_Semanal_h, 0), 
         Recomendacao = case_when( Utilizacao_pct > 100 ~ "Necess√°rio a√ß√£o imediata", 
                                    Utilizacao_pct > 85 ~ "Monitorar de perto", 
                                    Utilizacao_pct < 50 ~ "Verificar oportunidades", 
                                   TRUE ~ "Opera√ß√£o normal" ))

gargalos %>%
  select(Maquina, Utilizacao_pct, Horas_Deficit, Recomendacao) %>% 
  kable(format = "html", col.names = c("M√°quina", "Utiliza√ß√£o (%)", "D√©ficit (h)", "Recomenda√ß√£o")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), font_size = 14)
```
---

class: inverse, center, middle

# Estudo de Caso Integrado

---

# Caso Completo: F√°brica de Componentes

## Situa√ß√£o:
Uma f√°brica recebeu 5 pedidos urgentes que devem ser processados em 3 m√°quinas diferentes.
```{r caso-completo-dados, echo=TRUE}

# Dados do caso
pedidos <- data.frame( Pedido = paste0("P", 1:5), Cliente = c("Alpha", "Beta", "Alpha", "Gamma", "Delta"), Prazo_dias = c(5, 3, 6, 4, 5), Prioridade = c(2, 1, 3, 1, 2) )

# Roteiro de cada pedido
roteiro_completo <- data.frame( Pedido = rep(paste0("P", 1:5), each = 3), Operacao = rep(1:3, 5), Maquina = c("M1", "M2", "M3"), Setup_h = c(0.5, 0.3, 0.4, 0.5, 0.4, 0.3, 0.3, 0.5, 0.4, 0.5, 0.3, 0.4, 0.3, 0.4, 0.5), Proc_h = c(2.0, 1.5, 1.0, 1.0, 0.8, 1.2, 1.8, 2.2, 1.5, 1.5, 1.0, 1.3, 2.0, 1.5, 2.5) )
                                                                                                              # P1 "M1", "M3", "M2", 
                                                                                                              # P2 "M2", "M1", "M3", 
                                                                                                              # P3 "M1", "M2", "M3", 
                                                                                                              # P4 "M2", "M3", "M1"), 
                                                                                                              # P5 Setup_h = c(0.5, 0.3, 0.4, 
                                                                                                              # P1 0.5, 0.4, 0.3, 
                                                                                                              # P2 0.3, 0.5, 0.4, 
                                                                                                              # P3 0.5, 0.3, 0.4, 
                                                                                                              # P4 0.3, 0.4, 0.5), 
                                                                                                              # P5 Proc_h = c(2.0, 1.5, 1.0, # P1 1.0, 0.8, 1.2, 
                                                                                                              # P2 1.8, 2.2, 1.5, # P3 1.5, 1.0, 1.3, # P4 2.0, 1.5, 2.5) # P5 )

print(head(roteiro_completo, 9))
```
---

# Solu√ß√£o: Sequenciamento por Prioridade
```{r caso-sequenciamento, echo=TRUE}

#Calculando tempo total por pedido

tempo_pedidos <- roteiro_completo %>% 
  group_by(Pedido) %>% 
  summarise(Tempo_Total_h = sum(Setup_h + Proc_h)) %>% 
  left_join(pedidos, by = "Pedido") %>% 
  arrange(Prioridade, Prazo_dias)

print(tempo_pedidos)

#Sequenciamento final

sequencia_final <- tempo_pedidos %>% 
  mutate( Ordem_Exec = row_number(), Inicio_h = cumsum(dplyr::lag(Tempo_Total_h, default = 0)), Fim_h = Inicio_h + Tempo_Total_h, Prazo_h = Prazo_dias * 8, Atraso_h = pmax(0, Fim_h - Prazo_h))

print(sequencia_final)
```
---

# Solu√ß√£o: Carga de M√°quinas
```{r caso-carga, echo=TRUE, fig.height=4.5}

# Calculando carga por m√°quina
carga_caso <- roteiro_completo %>% 
  mutate(Carga_h = Setup_h + Proc_h) %>% 
  group_by(Maquina) %>% 
  summarise(Carga_Total_h = sum(Carga_h), Num_Operacoes = n()) %>% 
  mutate(Capacidade_h = 40, Utilizacao_pct = round((Carga_Total_h / Capacidade_h) * 100, 1))

# Gr√°fico

ggplot(carga_caso, aes(x = Maquina, y = Carga_Total_h)) + 
  geom_col(fill = "#3498db", alpha = 0.8) + geom_hline(yintercept = 40, linetype = "dashed", color = "red", size = 1) + 
  geom_text(aes(label = paste0(Carga_Total_h, "h\n", Utilizacao_pct, "%")), vjust = -0.5, fontface = "bold") + labs(title = "Carga Total por M√°quina - Estudo de Caso", subtitle = "Linha tracejada: capacidade semanal (40h)", x = "M√°quina", y = "Carga (horas)") + 
  theme_minimal(base_size = 14)
```
---

# Resultados e Recomenda√ß√µes

## An√°lise:
```{r caso-analise, echo=FALSE} 

analise <- data.frame( M√©trica = c("Makespan Total", "Taxa M√©dia de Utiliza√ß√£o", "Pedidos no Prazo", "Atraso M√©dio", "Gargalo Identificado"), Valor = c(paste0(round(max(sequencia_final$Fim_h), 1), " horas"), paste0(round(mean(carga_caso$Utilizacao_pct), 1), "%"), paste0(sum(sequencia_final$Atraso_h == 0), "/5"), paste0(round(mean(sequencia_final$Atraso_h), 1), " horas"), carga_caso$Maquina[which.max(carga_caso$Utilizacao_pct)]), Avalia√ß√£o = c("Dentro do esperado", "Boa utiliza√ß√£o", "Atende maioria", "Aceit√°vel", "Requer aten√ß√£o") )

analise %>% kable(format = "html") %>% kable_styling(bootstrap_options = c("striped", "hover"), font_size = 15)
```

## Recomenda√ß√µes:
- ‚úÖ Priorizar setup reduzido na m√°quina gargalo
- ‚úÖ Considerar horas extras para pedidos urgentes
- ‚úÖ Monitorar continuamente a carga da M1

---

class: inverse, center, middle

# Exerc√≠cios Pr√°ticos

---

# Exerc√≠cio 1: Criar seu Roteiro

## Desafio:
Crie um roteiro de produ√ß√£o para fabricar um **suporte met√°lico** com as seguintes opera√ß√µes:

1. Cortar chapa (Serra)
2. Dobrar 90¬∞ (Dobradeira)
3. Soldar cantos (Solda MIG)
4. Lixar rebarbas (Lixadeira)
5. Pintar (Cabine)

**Estime:**
- Tempos de setup
- Tempos de processamento
- Identifique preced√™ncias

---

# Exerc√≠cio 2: Sequenciamento
```{r exercicio-2, echo=TRUE}

#Dados do exerc√≠cio
ex_trabalhos <- data.frame( Trabalho = LETTERS[1:6], Tempo_Proc = c(5, 8, 3, 12, 6, 4), Data_Entrega = c(10, 15, 8, 20, 18, 12), Prioridade = c(2, 3, 1, 3, 2, 1) )

print(ex_trabalhos)
```

## Sua tarefa:
1. Aplique as regras: **SPT**, **EDD** e **Prioridade**
2. Calcule makespan e atraso m√©dio para cada regra
3. Qual regra √© melhor para este caso?

---

# Exerc√≠cio 3: An√°lise de Carga
```{r exercicio-3, echo=TRUE}

#Cen√°rio: 3 m√°quinas, 8 ordens
ex_ordens <- data.frame( Ordem = 1:8, Maquina = c("M1", "M1", "M2", "M2", "M3", "M3", "M1", "M2"), Setup_h = c(1, 0.5, 0.8, 1.2, 0.5, 1, 1, 0.8), Tempo_Unit_min = c(15, 20, 12, 25, 18, 15, 22, 14), Quantidade = c(50, 80, 120, 40, 60, 90, 70, 100) )

print(ex_ordens)
```


## Sua tarefa:
1. Calcule a carga total por m√°quina
2. Identifique gargalos (capacidade: 160h/m√™s)
3. Proponha solu√ß√µes

---

class: inverse, center, middle

# Ferramentas e Softwares

---

# Softwares para Programa√ß√£o da Produ√ß√£o

.pull-left[
## Softwares Comerciais
- **SAP PP** - Planejamento e Controle
- **Oracle SCM** - Supply Chain
- **Preactor APS** - Scheduling avan√ßado
- **Siemens Opcenter** - MES integrado
- **AspenTech** - Otimiza√ß√£o

## Open Source / R
- **simmer** - Simula√ß√£o discreta
- **rDEA** - An√°lise de efici√™ncia
- **optaplanner** - Otimiza√ß√£o
- **scheduleR** - Scheduling
]

.pull-right[
## Planilhas e Ferramentas Leves
- **Excel** com Solver
- **Google Sheets** + Scripts
- **Microsoft Project**
- **Ganttify**
- **Monday.com**

## Vantagens do R
‚úÖ Gratuito e c√≥digo aberto
‚úÖ Flexibilidade total
‚úÖ Reprodutibilidade
‚úÖ Visualiza√ß√µes avan√ßadas
‚úÖ Integra√ß√£o com outros sistemas
]

---

# Exemplo em R: Simula√ß√£o Simples
```{r simulacao-exemplo, echo=TRUE}

#Simulando chegada de ordens e processamento
set.seed(123)

simular_producao <- function(n_ordens = 20, n_maquinas = 3) { 
#Gerar ordens aleat√≥rias 

ordens <- data.frame( id = 1:n_ordens, chegada = cumsum(rexp(n_ordens, rate = 0.5)), tempo_proc = runif(n_ordens, 1, 5), maquina = sample(1:n_maquinas, n_ordens, replace = TRUE))

# Calcular tempos de conclus√£o (simplificado) 

ordens <- ordens %>% 
  arrange(maquina, chegada) %>% 
  group_by(maquina) %>% 
  mutate( inicio = pmax(chegada, dplyr::lag(chegada + tempo_proc, default = 0)), fim = inicio + tempo_proc, espera = inicio - chegada )

return(ordens) }

resultado_sim <- simular_producao() 
print(head(resultado_sim, 10))
```
---

# An√°lise da Simula√ß√£o
```{r analise-simulacao, echo=TRUE, fig.height=4.5}

#M√©tricas da simula√ß√£o
metricas_sim <- resultado_sim %>% summarise( Tempo_Medio_Espera = mean(espera), Tempo_Medio_Sistema = mean(fim - chegada), Makespan = max(fim), Utilizacao_Media = sum(tempo_proc) / (max(fim) * n_distinct(maquina)) )

print(metricas_sim)

#Gr√°fico de utiliza√ß√£o por m√°quina
resultado_sim %>% group_by(maquina) %>% summarise(tempo_ocupado = sum(tempo_proc)) %>% ggplot(aes(x = factor(maquina), y = tempo_ocupado)) + geom_col(fill = "#2ecc71") + labs(title = "Tempo Ocupado por M√°quina - Simula√ß√£o", x = "M√°quina", y = "Tempo (unidades)") + theme_minimal(base_size = 14)
```
---

class: inverse, center, middle

# Boas Pr√°ticas

---

# Princ√≠pios para Boa Programa√ß√£o

.pull-left[
## Planejamento
‚úÖ **Dados precisos**: Tempos, capacidades, restri√ß√µes

‚úÖ **Comunica√ß√£o**: Entre PCP, produ√ß√£o e vendas

‚úÖ **Flexibilidade**: Prever conting√™ncias

‚úÖ **Documenta√ß√£o**: Registrar decis√µes e mudan√ßas

## Execu√ß√£o
‚úÖ **Monitoramento**: Acompanhar progresso real

‚úÖ **Agilidade**: Reagir a imprevistos

‚úÖ **Prioriza√ß√£o**: Focar no cr√≠tico
]

.pull-right[
## An√°lise
‚úÖ **KPIs claros**: OEE, utiliza√ß√£o, pontualidade

‚úÖ **Revis√µes**: Analisar desvios periodicamente

‚úÖ **Melhoria cont√≠nua**: Ajustar m√©todos

## Tecnologia
‚úÖ **Automatiza√ß√£o**: Reduzir trabalho manual

‚úÖ **Integra√ß√£o**: Sistemas conversando

‚úÖ **Visualiza√ß√£o**: Dashboards em tempo real

‚úÖ **Backup**: Planos B e C
]

---

# Principais KPIs
```{r kpis, echo=FALSE} 
kpis <- data.frame( KPI = c("OEE", "Makespan", "Utiliza√ß√£o", "OTIF", "Lead Time", "WIP", "Setup Time"), Descri√ß√£o = c("Overall Equipment Effectiveness", "Tempo total de produ√ß√£o", "% tempo produtivo / tempo dispon√≠vel", "On Time In Full - entregas no prazo e completas", "Tempo do pedido at√© entrega", "Work In Process - estoque em processo", "Tempo m√©dio de prepara√ß√£o de m√°quinas"), Meta = c("> 85%", "Minimizar", "> 80%", "> 95%", "Reduzir", "Minimizar", "< 10% do ciclo"), Impacto = c("Efici√™ncia geral", "Prazo total", "Capacidade", "Satisfa√ß√£o cliente", "Agilidade", "Capital parado", "Flexibilidade") )

kpis %>% kable(format = "html") %>% kable_styling(bootstrap_options = c("striped", "hover"), font_size = 13)
```
---

# Checklist de Programa√ß√£o

## Antes de Programar:
- [ ] Todos os pedidos confirmados est√£o no sistema?
- [ ] Roteiros de produ√ß√£o atualizados?
- [ ] Capacidade das m√°quinas verificada?
- [ ] Materiais dispon√≠veis conferidos?
- [ ] Ferramental em condi√ß√µes?

## Durante a Programa√ß√£o:
- [ ] Prioridades definidas claramente?
- [ ] Restri√ß√µes consideradas (preced√™ncias, calend√°rio)?
- [ ] Gargalos identificados e tratados?
- [ ] Balanceamento de carga verificado?

## Ap√≥s Programar:
- [ ] Programa comunicado √† produ√ß√£o?
- [ ] Conting√™ncias planejadas?
- [ ] Sistema de acompanhamento ativo?

---

class: inverse, center, middle

# Resumo da Aula

---

# Principais Conceitos

## üìã Roteiro de Produ√ß√£o
- Documento t√©cnico que define **sequ√™ncia**, **m√°quinas**, **tempos** e **preced√™ncias**
- Base para planejamento e controle
- Deve ser mantido atualizado

## üî¢ Sequenciamento
- Ordem de execu√ß√£o das tarefas
- Regras: **SPT**, **EDD**, **FCFS**, **CR**, etc.
- Impacto direto em **prazos** e **custos**

## ‚öôÔ∏è Carga de M√°quinas
- Balanceamento entre **demanda** e **capacidade**
- Identifica√ß√£o de **gargalos** e **ociosidades**
- Decis√µes sobre **horas extras**, **subcontrata√ß√£o**, **investimentos**

---

# Ferramentas Apresentadas

## üîß Pr√°ticas
- C√°lculo manual de sequenciamento
- Planilhas de carga de m√°quinas
- Diagramas de Gantt
- An√°lise de KPIs


## üìä Anal√≠ticas
- M√©tricas de desempenho
- Identifica√ß√£o de gargalos
- Simula√ß√£o de cen√°rios
- Otimiza√ß√£o de decis√µes

---

# Para Saber Mais

## üìö Livros Recomendados
- **Administra√ß√£o da Produ√ß√£o** - Slack, Chambers & Johnston
- **Factory Physics** - Hopp & Spearman  
- **Theory of Constraints** - Goldratt
- **Scheduling** - Pinedo

## üåê Recursos Online
- APICS (Association for Supply Chain Management)
- ISE Magazine (Institute of Industrial Engineers)
- R for Operations Research
- Coursera: Operations Management

## üéì Pr√≥ximos Passos
- Simula√ß√£o de eventos discretos
- Programa√ß√£o linear e otimiza√ß√£o
- Teoria das Restri√ß√µes (TOC)


---
class: center, middle

.huge[
**D√öVIDAS?**
]


